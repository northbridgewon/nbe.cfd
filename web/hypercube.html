<html><head><base href="https://websim.ai" /><title>Rotating Hypercube</title>
<style>
  body {
    margin: 0;
    padding: 0;
    background-color: #000;
    overflow: hidden;
    font-family: Consolas, monaco, monospace;
    color: #fff;
    font-size: 14px;
  }
  canvas {
    display: block;
  }
  #controls {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background-color: rgba(0, 0, 0, 0.7);
    padding: 10px;
    border-radius: 5px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, auto);
    gap: 10px;
    max-width: 300px;
  }
  .slider-container {
    position: absolute;
    bottom: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #zoom-container {
    right: 20px;
  }
  #speed-container {
    right: 80px;
  }
  .vertical-slider {
    height: 200px;
    width: 30px;
    -webkit-appearance: slider-vertical;
    writing-mode: bt-lr;
  }
  .slider-label {
    margin-top: 10px;
  }
  label {
    display: flex;
    align-items: center;
    white-space: nowrap;
  }
  input[type="checkbox"] {
    margin-right: 5px;
  }
  #color-faces {
    grid-column: 1 / -1;
    justify-self: start;
  }
  #title {
    position: absolute;
    top: 20px;
    left: 0;
    right: 0;
    text-align: center;
  }
</style>
</head><body>
<div id="title">Four-dimensional hypercube projected into three-dimensional space</div>
<canvas id="canvas"></canvas>
<div id="controls">
  <label id="color-faces"><input type="checkbox" id="colorFaces" checked> Illuminate faces</label>
  <label><input type="checkbox" id="rotateXY" checked> XY</label>
  <label><input type="checkbox" id="rotateYZ" checked> YZ</label>
  <label><input type="checkbox" id="rotateZW" checked> ZW</label>
  <label><input type="checkbox" id="rotateXZ" checked> XZ</label>
  <label><input type="checkbox" id="rotateXW" checked> XW</label>
  <label><input type="checkbox" id="rotateYW" checked> YW</label>
</div>
<div id="zoom-container" class="slider-container">
  <input type="range" id="zoom" class="vertical-slider" min="50" max="300" value="150" orient="vertical">
  <span class="slider-label">Zoom</span>
</div>
<div id="speed-container" class="slider-container">
  <input type="range" id="speed" class="vertical-slider" min="1" max="100" value="15" orient="vertical">
  <span class="slider-label">Speed</span>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const scale = 0.5;
const vertices = [[scale, scale, scale, scale]];
vertices.forEach(v => vertices.push([-v[0], v[1], v[2], v[3]]));
vertices.forEach(v => vertices.push([v[0], -v[1], v[2], v[3]]));
vertices.forEach(v => vertices.push([v[0], v[1], -v[2], v[3]]));
vertices.forEach(v => vertices.push([v[0], v[1], v[2], -v[3]]));

const edges = [];
for (let i = 0; i < 16; i += 2) edges.push([i, i + 1]);
for (let i = 0; i < 16; i += 4) edges.push([i, i + 2], [i + 1, i + 3]);
for (let i = 0; i < 16; i += 8)
  edges.push([i, i + 4], [i + 1, i + 5], [i + 2, i + 6], [i + 3, i + 7]);
for (let i = 0; i < 8; i++) edges.push([i, i + 8]);

const faces = [
  [0, 1, 3, 2], [4, 5, 7, 6], [0, 1, 5, 4], [2, 3, 7, 6],
  [0, 2, 6, 4], [1, 3, 7, 5], [8, 9, 11, 10], [12, 13, 15, 14],
  [8, 9, 13, 12], [10, 11, 15, 14], [8, 10, 14, 12], [9, 11, 15, 13],
  [0, 1, 9, 8], [2, 3, 11, 10], [4, 5, 13, 12], [6, 7, 15, 14],
  [0, 2, 10, 8], [1, 3, 11, 9], [4, 6, 14, 12], [5, 7, 15, 13],
  [0, 4, 12, 8], [1, 5, 13, 9], [2, 6, 14, 10], [3, 7, 15, 11]
];

const faceColors = [
  'rgba(255, 0, 0, 0.2)', 'rgba(0, 255, 0, 0.2)', 'rgba(0, 0, 255, 0.2)',
  'rgba(255, 255, 0, 0.2)', 'rgba(255, 0, 255, 0.2)', 'rgba(0, 255, 255, 0.2)',
  'rgba(128, 0, 0, 0.2)', 'rgba(0, 128, 0, 0.2)', 'rgba(0, 0, 128, 0.2)',
  'rgba(128, 128, 0, 0.2)', 'rgba(128, 0, 128, 0.2)', 'rgba(0, 128, 128, 0.2)',
  'rgba(255, 128, 0, 0.2)', 'rgba(255, 0, 128, 0.2)', 'rgba(128, 255, 0, 0.2)',
  'rgba(0, 255, 128, 0.2)', 'rgba(128, 0, 255, 0.2)', 'rgba(0, 128, 255, 0.2)',
  'rgba(255, 128, 128, 0.2)', 'rgba(128, 255, 128, 0.2)', 'rgba(128, 128, 255, 0.2)',
  'rgba(255, 255, 128, 0.2)', 'rgba(255, 128, 255, 0.2)', 'rgba(128, 255, 255, 0.2)'
];

let angle = 0;
let zoomScale = 150;
let rotationSpeed = 0.003; // Slower default speed

function rotatePoint4D(p, rotations) {
  let [x, y, z, w] = p;

  if (rotations.xy) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [x, y] = [x * cos - y * sin, x * sin + y * cos];
  }
  
  if (rotations.xz) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [x, z] = [x * cos - z * sin, x * sin + z * cos];
  }
  
  if (rotations.xw) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [x, w] = [x * cos - w * sin, x * sin + w * cos];
  }
  
  if (rotations.yz) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [y, z] = [y * cos - z * sin, y * sin + z * cos];
  }
  
  if (rotations.yw) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [y, w] = [y * cos - w * sin, y * sin + w * cos];
  }

  if (rotations.zw) {
    let cos = Math.cos(angle);
    let sin = Math.sin(angle);
    [z, w] = [z * cos - w * sin, z * sin + w * cos];
  }

  return [x, y, z, w];
}

function stereographicProjection(p) {
  let [x, y, z, w] = p;
  let r = 1 / (1 - w);
  return [
    x * r * zoomScale + canvas.width / 2,
    y * r * zoomScale + canvas.height / 2
  ];
}

function drawTesseract() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const rotations = {
    xy: document.getElementById('rotateXY').checked,
    xz: document.getElementById('rotateXZ').checked,
    xw: document.getElementById('rotateXW').checked,
    yz: document.getElementById('rotateYZ').checked,
    yw: document.getElementById('rotateYW').checked,
    zw: document.getElementById('rotateZW').checked
  };

  let rotatedVertices = vertices.map(v => rotatePoint4D(v, rotations));
  let projectedVertices = rotatedVertices.map(stereographicProjection);

  // Draw illuminated faces
  if (document.getElementById('colorFaces').checked) {
    for (let i = 0; i < faces.length; i++) {
      ctx.beginPath();
      ctx.moveTo(projectedVertices[faces[i][0]][0], projectedVertices[faces[i][0]][1]);
      for (let j = 1; j < faces[i].length; j++) {
        ctx.lineTo(projectedVertices[faces[i][j]][0], projectedVertices[faces[i][j]][1]);
      }
      ctx.closePath();
      ctx.fillStyle = faceColors[i];
      ctx.fill();
    }
  }

  // Draw edges
  ctx.strokeStyle = '#0ff';
  ctx.lineWidth = 1.5;
  for (let edge of edges) {
    let p1 = projectedVertices[edge[0]];
    let p2 = projectedVertices[edge[1]];
    ctx.beginPath();
    ctx.moveTo(p1[0], p1[1]);
    ctx.lineTo(p2[0], p2[1]);
    ctx.stroke();
  }

  // Draw vertices
  ctx.fillStyle = '#ff00ff';
  for (let vertex of projectedVertices) {
    ctx.beginPath();
    ctx.arc(vertex[0], vertex[1], 3, 0, 2 * Math.PI);
    ctx.fill();
  }

  angle += rotationSpeed;
  requestAnimationFrame(drawTesseract);
}

drawTesseract();

document.getElementById('zoom').addEventListener('input', (e) => {
  zoomScale = parseInt(e.target.value);
});

document.getElementById('speed').addEventListener('input', (e) => {
  rotationSpeed = parseInt(e.target.value) / 10000;
});

window.addEventListener('resize', () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body></html>