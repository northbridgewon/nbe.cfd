<html><head><base href="https://websim.ai/c/"><style>
body, html {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  font-family: Arial, sans-serif;
}

.city-background {
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
  position: relative;
  overflow: hidden;
}

.ground {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 60px;
  background-color: #8B4513;
}

.building {
  position: absolute;
  bottom: 60px;
  background: #808080;
  display: flex;
  flex-direction: column-reverse;
}

.window {
  width: 10px;
  height: 10px;
  background: #FFFF99;
  margin: 5px;
}

.sun {
  position: absolute;
  top: 50px;
  left: 50px;
  width: 80px;
  height: 80px;
  background: #FFD700;
  border-radius: 50%;
  box-shadow: 0 0 50px #FFD700;
}

.cloud {
  position: absolute;
  background: #FFFFFF;
  border-radius: 50%;
}

.cloud::before,
.cloud::after {
  content: '';
  position: absolute;
  background: #FFFFFF;
  border-radius: 50%;
}

.cloud1 {
  width: 100px;
  height: 40px;
  top: 100px;
  left: 200px;
}

.cloud1::before {
  width: 50px;
  height: 50px;
  top: -25px;
  left: 10px;
}

.cloud1::after {
  width: 70px;
  height: 70px;
  top: -35px;
  right: 10px;
}

.cloud2 {
  width: 120px;
  height: 48px;
  top: 150px;
  right: 150px;
}

.cloud2::before {
  width: 60px;
  height: 60px;
  top: -30px;
  left: 12px;
}

.cloud2::after {
  width: 80px;
  height: 80px;
  top: -40px;
  right: 12px;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

.cloud1 {
  animation: float 8s ease-in-out infinite;
}

.cloud2 {
  animation: float 10s ease-in-out infinite reverse;
}

.entity {
  position: absolute;
  width: 20px;
  height: 40px;
  bottom: 60px;
  transition: all 0.5s linear;
}

.person {
  background-color: #000;
}

.person::before {
  content: '';
  position: absolute;
  top: 0;
  left: 5px;
  width: 10px;
  height: 10px;
  background: #000;
  border-radius: 50%;
}

.murderer {
  background-color: #FF0000;
  z-index: 10;
}

.murderer::before {
  background-color: #800000;
}

.police {
  background-color: #0000FF;
  z-index: 10;
}

.police::before {
  background-color: #000080;
}

.zombie {
  background-color: #00FF00;
  z-index: 10;
}

.zombie::before {
  background-color: #008000;
}

.dog {
  width: 30px;
  height: 20px;
  background-color: #8B4513;
  border-radius: 10px;
}

.dog::before {
  content: '';
  position: absolute;
  top: -5px;
  left: 20px;
  width: 10px;
  height: 10px;
  background: #8B4513;
  border-radius: 50%;
}

.dog::after {
  content: '';
  position: absolute;
  top: 15px;
  right: -5px;
  width: 10px;
  height: 5px;
  background: #8B4513;
  border-radius: 5px;
}

.genie {
  width: 40px;
  height: 60px;
  background-color: #8A2BE2;
  border-radius: 20px 20px 0 0;
  z-index: 20;
}

.genie::before {
  content: '';
  position: absolute;
  top: -15px;
  left: 10px;
  width: 20px;
  height: 20px;
  background: #8A2BE2;
  border-radius: 50%;
}

.genie::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 0;
  width: 40px;
  height: 20px;
  background: #4B0082;
  border-radius: 50%;
}

.batman {
  width: 30px;
  height: 50px;
  background-color: #333;
  border-radius: 10px 10px 0 0;
  z-index: 15;
}

.batman::before {
  content: '';
  position: absolute;
  top: -10px;
  left: 0;
  width: 30px;
  height: 15px;
  background: #333;
  border-radius: 15px 15px 0 0;
}

.batman::after {
  content: '';
  position: absolute;
  top: 5px;
  left: 5px;
  width: 20px;
  height: 10px;
  background: #FFD700;
  clip-path: polygon(0% 0%, 100% 0%, 80% 100%, 20% 100%);
}

.batman-who-laughs {
  width: 30px;
  height: 50px;
  background-color: #4a0e0e;
  border-radius: 10px 10px 0 0;
  z-index: 15;
}

.batman-who-laughs::before {
  content: '';
  position: absolute;
  top: -10px;
  left: 0;
  width: 30px;
  height: 15px;
  background: #4a0e0e;
  border-radius: 15px 15px 0 0;
}

.batman-who-laughs::after {
  content: '';
  position: absolute;
  top: 5px;
  left: 5px;
  width: 20px;
  height: 10px;
  background: #FF0000;
  clip-path: polygon(0% 0%, 100% 0%, 80% 100%, 20% 100%);
}

@keyframes float-genie {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.genie {
  animation: float-genie 3s ease-in-out infinite;
}

#spawn-buttons {
  position: absolute;
  top: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.spawn-button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
}

.spawn-button:hover {
  opacity: 0.8;
}

#spawn-murderer {
  background-color: #FF0000;
}

#spawn-police {
  background-color: #0000FF;
}

#spawn-zombie {
  background-color: #00FF00;
}

#spawn-dog {
  background-color: #8B4513;
}

#spawn-genie {
  background-color: #8A2BE2;
}

#spawn-batman {
  background-color: #333;
}

#half-population {
  background-color: #800080;
}

#message {
  position: absolute;
  top: 20px;
  left: 20px;
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 10px;
  border-radius: 5px;
  font-size: 16px;
  text-align: left;
}

#event-log {
  position: absolute;
  bottom: 70px;
  left: 10px;
  width: 300px;
  height: 150px;
  background-color: rgba(255, 255, 255, 0.8);
  border-radius: 5px;
  padding: 10px;
  font-size: 14px;
  overflow-y: auto;
}

#population-counter {
  position: absolute;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(0, 0, 0, 0.7);
  color: white;
  padding: 10px;
  border-radius: 5px;
  font-size: 24px;
  text-align: center;
}

#wish-interface {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: rgba(255, 255, 255, 0.9);
  padding: 20px;
  border-radius: 10px;
  text-align: center;
}

#wish-interface h2 {
  margin-top: 0;
}

#wish-interface input {
  width: 80%;
  padding: 10px;
  margin: 10px 0;
}

#wish-interface button {
  padding: 10px 20px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

#wish-interface button:hover {
  opacity: 0.8;
}

</style></head><body>
<div class="city-background">
  <div class="sun"></div>
  <div class="cloud cloud1"></div>
  <div class="cloud cloud2"></div>
  <div class="ground"></div>
</div>
<div id="spawn-buttons">
  <button id="spawn-person" class="spawn-button">Spawn Person</button>
  <button id="spawn-murderer" class="spawn-button">Spawn Murderer</button>
  <button id="spawn-police" class="spawn-button">Spawn Police</button>
  <button id="spawn-zombie" class="spawn-button">Spawn Zombie</button>
  <button id="spawn-dog" class="spawn-button">Spawn Dog</button>
  <button id="spawn-genie" class="spawn-button">Spawn Genie</button>
  <button id="spawn-batman" class="spawn-button">Spawn Batman</button>
  <button id="half-population" class="spawn-button">Half Population</button>
</div>
<div id="message"></div>
<div id="event-log"></div>
<div id="population-counter">Population: 0</div>
<div id="wish-interface">
  <h2>Make a Wish!</h2>
  <input type="text" id="wish-input" placeholder="Enter your wish...">
  <button id="make-wish">Make Wish</button>
  <p id="wishes-left">Wishes left: 3</p>
</div>

<script>
let murdererCount = 0;
let innocentCount = 0;
let policeCount = 0;
let zombieCount = 0;
let dogCount = 0;
let genieCount = 0;
let batmanCount = 0;
let batmanWhoLaughsCount = 0;
let entities = [];
let activeGenie = null;
let wishesLeft = 3;

class Entity {
  constructor(x, type) {
    this.x = x;
    this.type = type;
    this.element = document.createElement('div');
    this.element.className = 'entity ' + type;
    document.querySelector('.city-background').appendChild(this.element);
    this.update();
    if (type === 'batman-who-laughs') {
      this.spawnTimer = setInterval(() => this.spawnZombies(), 10000);
    }
  }

  update() {
    this.element.style.left = this.x + 'px';
  }

  move() {
    const dx = (Math.random() - 0.5) * 20;
    this.x = Math.max(0, Math.min(window.innerWidth - 20, this.x + dx));
    this.update();
  }

  chase(target) {
    const dx = target.x - this.x;
    const distance = Math.abs(dx);
    if (distance > 5) {
      const speed = this.type === 'batman' || this.type === 'batman-who-laughs' ? 6 : 5; // Batman and Batman Who Laughs are slightly faster
      this.x += (dx / distance) * speed;
    }
    this.update();
  }

  remove() {
    this.element.remove();
    entities = entities.filter(e => e !== this);
    if (this.type === 'person') innocentCount--;
    else if (this.type === 'murderer') murdererCount--;
    else if (this.type === 'police') policeCount--;
    else if (this.type === 'zombie') zombieCount--;
    else if (this.type === 'dog') dogCount--;
    else if (this.type === 'genie') genieCount--;
    else if (this.type === 'batman') batmanCount--;
    else if (this.type === 'batman-who-laughs') {
      batmanWhoLaughsCount--;
      clearInterval(this.spawnTimer);
    }
    updateMessage();
    updatePopulationCounter();
  }

  changeType(newType) {
    if (this.type === 'person') innocentCount--;
    else if (this.type === 'murderer') murdererCount--;
    else if (this.type === 'police') policeCount--;
    else if (this.type === 'zombie') zombieCount--;
    else if (this.type === 'dog') dogCount--;
    else if (this.type === 'genie') genieCount--;
    else if (this.type === 'batman') batmanCount--;
    else if (this.type === 'batman-who-laughs') {
      batmanWhoLaughsCount--;
      clearInterval(this.spawnTimer);
    }

    this.type = newType;
    this.element.className = 'entity ' + newType;

    if (newType === 'person') innocentCount++;
    else if (newType === 'murderer') murdererCount++;
    else if (newType === 'police') policeCount++;
    else if (newType === 'zombie') zombieCount++;
    else if (newType === 'dog') dogCount++;
    else if (newType === 'genie') genieCount++;
    else if (newType === 'batman') batmanCount++;
    else if (newType === 'batman-who-laughs') {
      batmanWhoLaughsCount++;
      this.spawnTimer = setInterval(() => this.spawnZombies(), 10000);
    }

    updateMessage();
    updatePopulationCounter();
  }

  spawnZombies() {
    for (let i = 0; i < 2; i++) {
      createEntity('zombie');
    }
    logEvent('The Batman Who Laughs spawned 2 zombies!');
  }
}

function createBuilding(x, width, height) {
  const building = document.createElement('div');
  building.className = 'building';
  building.style.left = x + 'px';
  building.style.width = width + 'px';
  building.style.height = height + 'px';

  const floors = Math.floor(height / 30);
  const windowsPerFloor = Math.floor(width / 25);

  for (let i = 0; i < floors; i++) {
    for (let j = 0; j < windowsPerFloor; j++) {
      const window = document.createElement('div');
      window.className = 'window';
      building.appendChild(window);
    }
  }

  document.querySelector('.city-background').appendChild(building);
}

function generateSkyline() {
  const cityBackground = document.querySelector('.city-background');
  const width = cityBackground.offsetWidth;
  const height = cityBackground.offsetHeight - 60;

  let x = 0;
  while (x < width) {
    const buildingWidth = Math.floor(Math.random() * 100) + 50;
    const buildingHeight = Math.floor(Math.random() * (height * 0.7)) + (height * 0.3);
    createBuilding(x, buildingWidth, buildingHeight);
    x += buildingWidth + Math.floor(Math.random() * 20);
  }
}

function createEntity(type) {
  const x = Math.random() * (window.innerWidth - 20);
  const entity = new Entity(x, type);
  entities.push(entity);

  if (type === 'murderer') {
    murdererCount++;
  } else if (type === 'person') {
    innocentCount++;
  } else if (type === 'police') {
    policeCount++;
  } else if (type === 'zombie') {
    zombieCount++;
  } else if (type === 'dog') {
    dogCount++;
  } else if (type === 'genie') {
    genieCount++;
  } else if (type === 'batman') {
    batmanCount++;
  } else if (type === 'batman-who-laughs') {
    batmanWhoLaughsCount++;
  }

  updateMessage();
  updatePopulationCounter();
}

function updateMessage() {
  const message = document.getElementById('message');
  message.innerHTML = `
    Innocents: ${innocentCount}<br>
    Murderers: ${murdererCount}<br>
    Police: ${policeCount}<br>
    Zombies: ${zombieCount}<br>
    Dogs: ${dogCount}<br>
    Genies: ${genieCount}<br>
    Batman: ${batmanCount}<br>
    Batman Who Laughs: ${batmanWhoLaughsCount}
  `;
}

function updatePopulationCounter() {
  const populationCounter = document.getElementById('population-counter');
  const totalPopulation = innocentCount + murdererCount + policeCount + zombieCount + dogCount + genieCount + batmanCount + batmanWhoLaughsCount;
  populationCounter.textContent = `Population: ${totalPopulation}`;
}

function logEvent(event) {
  const eventLog = document.getElementById('event-log');
  const eventElement = document.createElement('div');
  eventElement.textContent = event;
  eventLog.appendChild(eventElement);
  eventLog.scrollTop = eventLog.scrollHeight;
}

function gameLoop() {
  entities.forEach(entity => {
    if (entity.type === 'murderer') {
      const closestZombie = entities.find(e => e.type === 'zombie');
      if (closestZombie) {
        entity.chase(closestZombie);
      } else {
        const closestPerson = entities.find(e => e.type === 'person');
        if (closestPerson) {
          entity.chase(closestPerson);
        } else {
          entity.move();
        }
      }
    } else if (entity.type === 'police') {
      const closestMurderer = entities.find(e => e.type === 'murderer');
      if (closestMurderer) {
        entity.chase(closestMurderer);
      } else {
        entity.move();
      }
    } else if (entity.type === 'zombie') {
      const closestPerson = entities.find(e => e.type === 'person' || e.type === 'police' || e.type === 'batman');
      if (closestPerson) {
        entity.chase(closestPerson);
      } else {
        entity.move();
      }
    } else if (entity.type === 'dog') {
      const closestMurderer = entities.find(e => e.type === 'murderer');
      if (closestMurderer) {
        entity.chase(closestMurderer);
      } else {
        const closestZombie = entities.find(e => e.type === 'zombie');
        if (closestZombie) {
          entity.chase(closestZombie);
        } else {
          entity.move();
        }
      }
    } else if (entity.type === 'batman') {
      const closestMurderer = entities.find(e => e.type === 'murderer');
      if (closestMurderer) {
        entity.chase(closestMurderer);
      } else {
        entity.move();
      }
    } else if (entity.type === 'batman-who-laughs') {
      const closestPerson = entities.find(e => e.type === 'person' || e.type === 'police');
      if (closestPerson) {
        entity.chase(closestPerson);
      } else {
        entity.move();
      }
    } else {
      entity.move();
    }
  });

  // Check for collisions
  for (let i = 0; i < entities.length; i++) {
    for (let j = i + 1; j < entities.length; j++) {
      const e1 = entities[i];
      const e2 = entities[j];
      const distance = Math.abs(e1.x - e2.x);

      if (distance < 20) {
        // Collision detected
        if (e1.type === 'murderer' && e2.type === 'person') {
          e2.remove();
          logEvent('A murderer killed an innocent person!');
        } else if (e1.type === 'person' && e2.type === 'murderer') {
          e1.remove();
          logEvent('A murderer killed an innocent person!');
        } else if ((e1.type === 'police' && e2.type === 'murderer') || (e1.type === 'murderer' && e2.type === 'police')) {
          if (Math.random() < 0.5) {
            // Police wins
            (e1.type === 'murderer' ? e1 : e2).remove();
            logEvent('A police officer caught a murderer!');
          } else {
            // Murderer wins
            (e1.type === 'police' ? e1 : e2).remove();
            logEvent('A murderer escaped from a police officer!');
          }
        } else if ((e1.type === 'police' && e2.type === 'person') || (e1.type === 'person' && e2.type === 'police')) {
          if (Math.random() < 0.01) {
            // Wrongful arrest
            const police = e1.type === 'police' ? e1 : e2;
            police.changeType('person');
            logEvent('A police officer wrongfully arrested an innocent person and lost their job!');
          }
        } else if ((e1.type === 'zombie' && (e2.type === 'person' || e2.type === 'police')) || 
                   ((e1.type === 'person' || e1.type === 'police') && e2.type === 'zombie')) {
          const victim = e1.type === 'zombie' ? e2 : e1;
          victim.changeType('zombie');
          logEvent(`A zombie infected a ${victim.type === 'police' ? 'police officer' : 'person'}!`);
        } else if ((e1.type === 'murderer' && e2.type === 'zombie') || (e1.type === 'zombie' && e2.type === 'murderer')) {
          const zombie = e1.type === 'zombie' ? e1 : e2;
          zombie.remove();
          logEvent('A murderer eliminated a zombie!');
        } else if ((e1.type === 'dog' && e2.type === 'zombie') || (e1.type === 'zombie' && e2.type === 'dog')) {
          const zombie = e1.type === 'zombie' ? e1 : e2;
          zombie.remove();
          logEvent('A brave dog defeated a zombie!');
        } else if ((e1.type === 'dog' && e2.type === 'murderer') || (e1.type === 'murderer' && e2.type === 'dog')) {
          const murderer = e1.type === 'murderer' ? e1 : e2;
          murderer.changeType('person');
          logEvent('A loyal dog converted a murderer into a regular person!');
        } else if ((e1.type === 'genie' && e2.type !== 'genie') || (e2.type === 'genie' && e1.type !== 'genie')) {
          const genie = e1.type === 'genie' ? e1 : e2;
          const other = e1.type === 'genie' ? e2 : e1;
          if (activeGenie === null) {
            activeGenie = genie;
            showWishInterface();
            logEvent(`A genie has been summoned by a ${other.type}!`);
          }
        } else if ((e1.type === 'batman' && e2.type === 'murderer') || (e1.type === 'murderer' && e2.type === 'batman')) {
          const murderer = e1.type === 'murderer' ? e1 : e2;
          const batman = e1.type === 'batman' ? e1 : e2;
          murderer.remove();
          logEvent('Batman eliminated a murderer!');
          
          // Find nearby witnesses
          const witnesses = entities.filter(e => e.type === 'person' && Math.abs(e.x - batman.x) < 50);
          witnesses.forEach(witness => {
            witness.changeType('murderer');
            logEvent('A person witnessed Batman killing a murderer and became a murderer!');
          });
        } else if ((e1.type === 'zombie' && e2.type === 'batman') || (e1.type === 'batman' && e2.type === 'zombie')) {
          const batman = e1.type === 'batman' ? e1 : e2;
          batman.changeType('batman-who-laughs');
          logEvent('A zombie infected Batman, turning him into the Batman Who Laughs!');
        } else if ((e1.type === 'batman-who-laughs' && (e2.type === 'person' || e2.type === 'police')) || 
                   ((e1.type === 'person' || e1.type === 'police') && e2.type === 'batman-who-laughs')) {
          const victim = e1.type === 'batman-who-laughs' ? e2 : e1;
          victim.changeType('zombie');
          logEvent(`The Batman Who Laughs turned a ${victim.type === 'police' ? 'police officer' : 'person'} into a zombie!`);
        }
      }
    }
  }

  requestAnimationFrame(gameLoop);
}

function spawnPerson() {
  createEntity('person');
}

function spawnMurderer() {
  createEntity('murderer');
}

function spawnPolice() {
  createEntity('police');
}

function spawnZombie() {
  createEntity('zombie');
}

function spawnDog() {
  createEntity('dog');
}

function spawnGenie() {
  createEntity('genie');
}

function spawnBatman() {
  createEntity('batman');
}

function halfPopulation() {
  const totalPopulation = entities.length;
  const entitiesToRemove = Math.floor(totalPopulation / 2);
  
  for (let i = 0; i < entitiesToRemove; i++) {
    if (entities.length > 0) {
      const randomIndex = Math.floor(Math.random() * entities.length);
      entities[randomIndex].remove();
    }
  }
  
  logEvent(`Half of the population (${entitiesToRemove} entities) has been removed!`);
  updateMessage();
  updatePopulationCounter();
}

function showWishInterface() {
  document.getElementById('wish-interface').style.display = 'block';
}

function hideWishInterface() {
  document.getElementById('wish-interface').style.display = 'none';
}

function makeWish() {
  const wishInput = document.getElementById('wish-input');
  const wish = wishInput.value.trim();

  if (wish && wishesLeft > 0) {
    logEvent(`A wish has been made: "${wish}"`);
    wishesLeft--;
    document.getElementById('wishes-left').textContent = `Wishes left: ${wishesLeft}`;
    wishInput.value = '';

    // Implement wish effects here
    if (wish.toLowerCase().includes('more')) {
      for (let i = 0; i < 10; i++) {
        createEntity('person');
      }
      logEvent('The genie granted more people!');
    } else if (wish.toLowerCase().includes('peace')) {
      entities.forEach(entity => {
        if (entity.type === 'murderer' || entity.type === 'zombie' || entity.type === 'batman-who-laughs') {
          entity.changeType('person');
        }
      });
      logEvent('The genie brought peace to the city!');
    } else if (wish.toLowerCase().includes('chaos')) {
      for (let i = 0; i < 5; i++) {
        createEntity('murderer');
        createEntity('zombie');
      }
      logEvent('The genie unleashed chaos upon the city!');
    } else {
      logEvent('The genie couldn\'t understand the wish. Nothing happened.');
    }

    if (wishesLeft === 0) {
      activeGenie.remove();
      activeGenie = null;
      hideWishInterface();
      logEvent('The genie disappeared after granting three wishes!');
    }
  }
}

window.addEventListener('load', () => {
  generateSkyline();
  gameLoop();
  updateMessage();
  updatePopulationCounter();
});

window.addEventListener('resize', () => {
  document.querySelector('.city-background').innerHTML = '<div class="sun"></div><div class="cloud cloud1"></div><div class="cloud cloud2"></div><div class="ground"></div>';
  generateSkyline();
});

document.getElementById('spawn-person').addEventListener('click', spawnPerson);
document.getElementById('spawn-murderer').addEventListener('click', spawnMurderer);
document.getElementById('spawn-police').addEventListener('click', spawnPolice);
document.getElementById('spawn-zombie').addEventListener('click', spawnZombie);
document.getElementById('spawn-dog').addEventListener('click', spawnDog);
document.getElementById('spawn-genie').addEventListener('click', spawnGenie);
document.getElementById('spawn-batman').addEventListener('click', spawnBatman);
document.getElementById('half-population').addEventListener('click', halfPopulation);
document.getElementById('make-wish').addEventListener('click', makeWish);

""
</script>
</body></html>